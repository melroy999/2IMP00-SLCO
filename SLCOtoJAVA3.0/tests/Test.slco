model Test {
    actions actionA actionB

    classes
    P {
        variables Boolean[2] x Integer i Integer[2] A Integer[2] B
        state machines
        SM1 {
            variables Integer y
            initial SMC0 states SMC1
            transitions
                from SMC0 to SMC1 {
                    [not x[i] || x[i]; i := i+1; x[i]:=i=2; i:= 3; x[0]:= False]
                }
                from SMC0 to SMC1 {
                    [i := i+1; x[i]:=i=2; i:= 3; x[0]:= False]
                }
                from SMC0 to SMC1 {
                    [not x[i]; i := i+1; x[i]:=i=2; i:= 3; x[0]:= False]
                }
                from SMC0 to SMC1 {
                    True; i := i+1; x[i]:=i=2; i:= 3; x[0]:= False
                }
        }
        SM2 {
            variables Integer u
            initial SMC0
            transitions
                from SMC0 to SMC0 {
                    A[B[u]] := B[u];
                    u := (u + 1) % 2;
                    B[A[u]] := A[u];
                }
        }
    }
    objects p: P(x:=[False,True],i:=0)
}
